"use strict";(()=>{var e={};e.id=600,e.ids=[600],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},6748:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>h,requestAsyncStorage:()=>f,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{GET:()=>m});var o=r(9303),i=r(8716),a=r(670),n=r(7070),p=r(629),u=r(5315),l=r.n(u),d=r(2048);async function m(e,{params:t}){try{let{type:e,filename:r}=t;if(!["videos","projects"].includes(e))return n.NextResponse.json({error:"Неверный тип файла"},{status:400});let s=l().join(process.cwd(),"data","uploads",e,r),o=l().join(process.cwd(),"data","uploads");if(!l().resolve(s).startsWith(l().resolve(o)))return n.NextResponse.json({error:"Доступ запрещен"},{status:403});if(!(0,d.existsSync)(s))return n.NextResponse.json({error:"Файл не найден"},{status:404});let i=await (0,p.readFile)(s),a="application/octet-stream";if("videos"===e){let e=l().extname(r).toLowerCase();".mp4"===e?a="video/mp4":".webm"===e?a="video/webm":".mov"===e&&(a="video/quicktime")}else{let e=l().extname(r).toLowerCase();".jpg"===e||".jpeg"===e?a="image/jpeg":".png"===e?a="image/png":".gif"===e?a="image/gif":".webp"===e&&(a="image/webp")}return new n.NextResponse(i,{headers:{"Content-Type":a,"Cache-Control":"public, max-age=31536000, immutable"}})}catch(e){return console.error("Error serving file:",e),n.NextResponse.json({error:"Ошибка при получении файла"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/files/[type]/[filename]/route",pathname:"/api/files/[type]/[filename]",filename:"route",bundlePath:"app/api/files/[type]/[filename]/route"},resolvedPagePath:"C:\\Users\\Gleb\\Desktop\\Site\\site_maxvich1\\src\\app\\api\\files\\[type]\\[filename]\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:x,serverHooks:g}=c,v="/api/files/[type]/[filename]/route";function h(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:x})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972],()=>r(6748));module.exports=s})();